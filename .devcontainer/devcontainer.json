// For format details, see https://aka.ms/devcontainer.json.
{
    "name": "cproject",
    "dockerComposeFile": "docker-compose.yml",
    "service": "cproject",
    "workspaceFolder": "/workspace",
    // Generate .devcontainer/.env containing WORKSPACE_* envars for docker-compose.yml
    "initializeCommand": ".devcontainer/gen-docker-compose-workspace-env.sh --container-workspace-folder '${containerWorkspaceFolder}' --local-workspace-folder '${localWorkspaceFolder}'",
	"mounts": [
		// ... existing mounts ...
	
		"source=${localEnv:HOME}/.ssh,target=/home/vscode/.ssh,type=bind,consistency=cached",
		"source=${localEnv:HOME}/.gnupg,target=/home/vscode/.gnupg,type=bind,consistency=cached"
	],
    // "remoteEnv": {
    //     "PROJ_DIR": "minishell"
    // },
    "features": {
        "ghcr.io/devcontainers/features/common-utils:2": {
            "installZsh": "true",
            "username": "vscode",
            "userUid": "1000",
            "userGid": "1000",
            "upgradePackages": "true"
        },
        "ghcr.io/devcontainers/features/ruby:1": "3.2.2",
        "ghcr.io/devcontainers/features/git:1": {
            "version": "latest",
            "ppa": "false"
        }
    },
    // "postCreateCommand": "sudo gem install ceedling",

    // General properties unrelated to the example follow...
    "remoteUser": "vscode",
    "customizations": {
        "vscode": {
            "settings": {
				"C_Cpp.intelliSenseEngine": "disabled",
				"clangd.fallbackFlags": ["-I ${containerWorkspaceFolder}/${containerEnv:PROJ_DIR}/include"],
				"clangd.arguments": ["-I ${containerWorkspaceFolder}/${containerEnv:PROJ_DIR}/include"],

                "ceedlingExplorer.projectPath": "${containerWorkspaceFolder}/${containerEnv:PROJ_DIR}",
                "terminal.integrated.profiles.linux": { "zsh": { "path": "/bin/zsh" } },
				"terminal.integrated.defaultProfile.linux": "zsh",
				"terminal.integrated.cwd": "${containerWorkspaceFolder}/${containerEnv:ZSH_CWD}",

				// settings from local install
				"doxdocgen.c.firstLine": "/**",
				"doxdocgen.c.triggerSequence": "//**",
				"workbench.colorTheme": "GitHub Dark",
				"workbench.iconTheme": "Monokai Classic Icons",
				"workbench.settings.applyToAllProfiles": [
					"editor.renderWhitespace"
				],
				"grunt.autoDetect": "on",
				"explorer.confirmDragAndDrop": false,
				"settingsSync.ignoredExtensions": [
					"golang.go",
					"golang.go-nightly",
					"shd101wyy.markdown-preview-enhanced"
				],
				"files.autoSave": "afterDelay",
				"go.toolsManagement.autoUpdate": true,
				"window.commandCenter": false,
				"gitlens.mode.active": "zen",
				"explorer.confirmDelete": false,
				"git.autofetch": true,
				"extensions.ignoreRecommendations": true,
				"github.copilot.enable": {
					"plaintext": false,
					"markdown": false,
					"scminput": false
				},
				"editor.minimap.enabled": false,
				"editor.detectIndentation": false,
				"C_Cpp.doxygen.generatedStyle": "/**",
				"C_Cpp.codeAnalysis.clangTidy.enabled": true,
				"testExplorer.useNativeTesting": true,
				"[c]":{
					"editor.wordWrap": "wordWrapColumn",
					"editor.wordWrapColumn": 80
				},
				"editor.tabSize": 4,
				"editor.insertSpaces": false,
				"inline-bookmarks.view.showVisibleFilesOnly": false,
				"C_Cpp.default.forcedInclude": ["**/**"]
			    },
                "extensions": [
					"github.copilot-chat",
					"tintinweb.vscode-inline-bookmarks",
					"DoKca.42-ft-count-line",
					"kube.42header",
					"timonwong.shellcheck",
					"ms-vscode.cpptools",
					"cschlosser.doxdocgen",
					"numaru.vscode-ceedling-test-adapter",
					"hbenl.vscode-test-explorer",
					"ms-vscode.test-adapter-converter",
					"llvm-vs-code-extensions.vscode-clangd"
				],
				"workbench.editorAssociations": [
					{
						"viewType": "vscode.markdown.preview.editor",
						"filenamePattern": "*.md"
					}
				]
            }
    }
}
